<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#120106" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-title" content="Telegram Game" />
    <!-- Request fullscreen mode -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="msapplication-tap-highlight" content="no" />
    <!-- Prevent browser UI from showing -->
    <meta name="format-detection" content="telephone=no,email=no,address=no" />
    <title>Telegram Game</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/animations.css" />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "game-purple": "#2D1B3D",
              "game-pink": "#E91E63",
              "game-gold": "#FFD700",
              "game-ruby": "#E53E3E",
            },
            fontFamily: {
              game: ["Arial", "sans-serif"],
            },
          },
        },
      };
    </script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Gugi&display=swap");

      /* CSS Variables for dynamic viewport */
      :root {
        --vh: 1vh;
        --safe-area-inset-top: env(safe-area-inset-top);
        --safe-area-inset-bottom: env(safe-area-inset-bottom);
        --safe-area-inset-left: env(safe-area-inset-left);
        --safe-area-inset-right: env(safe-area-inset-right);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        width: 100%;
        overflow-x: hidden;
        position: fixed;
        -webkit-overflow-scrolling: touch;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        font-family: "Arial", sans-serif;
        background-color: #120106;
        min-height: 100vh;
        min-height: calc(var(--vh, 1vh) * 100);
        min-height: -webkit-fill-available;
        width: 100vw;
        display: block;
        position: relative;
        color: white;
        margin: 0;
        padding: 0;
        /* iOS Safari specific fixes */
        padding-top: var(--safe-area-inset-top);
        padding-bottom: var(--safe-area-inset-bottom);
        padding-left: var(--safe-area-inset-left);
        padding-right: var(--safe-area-inset-right);
      }

      /* Fix for iOS Safari viewport height issues */
      @supports (-webkit-touch-callout: none) {
        body {
          min-height: -webkit-fill-available;
          min-height: calc(var(--vh, 1vh) * 100);
        }
      }

      /* Main container positioned in center like a phone */
      .phone-container {
        max-width: 375px;
        width: 100%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        min-height: 100vh;
        min-height: calc(var(--vh, 1vh) * 100);
        min-height: -webkit-fill-available;
        max-height: 100vh;
        max-height: calc(var(--vh, 1vh) * 100);
        max-height: -webkit-fill-available;
        display: flex;
        flex-direction: column;
        background: linear-gradient(180deg, #2d1b3d 0%, #1a0f2e 100%);
        background-image: url("./images/screen1/background-image.png");
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        border-radius: 16px;
        overflow: hidden;
        /* Touch optimization */
        -webkit-transform: translate(-50%, -50%);
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        will-change: transform;
      }

      .progress-bar {
        background: linear-gradient(90deg, #e45f90 0%, #f06292 100%);
        height: 8px;
      }

      .progress-icon {
        position: absolute;
        border-radius: 0.5px;
        background: linear-gradient(0deg, #bac1d6 0.01%, #ffffff 99.98%);
        width: 5.5px;
        height: 14px;
        top: -1px;
        transition: left 0.3s ease;
      }

      .stage-platform {
        background: conic-gradient(
          from 0deg,
          #e91e63,
          #f8bbd9,
          #e91e63,
          #f8bbd9,
          #e91e63
        );
        border-radius: 50%;
      }

      .curtain-bg {
        background: linear-gradient(
          180deg,
          #8b4513 0%,
          #654321 50%,
          #3e2723 100%
        );
      }
      #main-stage {
        position: relative;
        z-index: 30;
      }
      .background-color-gradient {
        background: radial-gradient(
          50% 50% at 50% 50%,
          #450832 0%,
          #2e032c 100%
        );
        backdrop-filter: blur(10px);
        border: 1px solid;
        border: 1px solid rgba(215, 12, 163, 0.42);
      }
      .background-bottom-nav {
        background-color: #27012a;
        border: 1px solid;
        border: 1px solid rgba(215, 12, 163, 0.42);
      }
      .resource-header {
        height: 30px;
      }
      .level-bars {
        background-color: #4ade806b;
        height: 12px;
      }
      .gugi-regular {
        font-family: "Gugi", sans-serif;
        font-weight: 400;
        font-style: normal;
      }

      /* Auto earn button styles */
      #auto-earn-button.active {
        background: radial-gradient(
          50% 50% at 50% 50%,
          #450832 0%,
          #2e032c 100%
        );
      }
      #auto-earn-button:not(.active) {
        background: radial-gradient(
          50% 50% at 50% 50%,
          rgba(69, 8, 50, 0.5) 0%,
          rgba(46, 3, 44, 0.5) 100%
        );
      }

      /* Auto earn button default position - override all media queries */
      .auto-earn-container {
        position: absolute !important;
        right: 16px !important;
        bottom: 180px !important; /* ƒê·∫∑t d∆∞·ªõi ch√¢n younghee m·∫∑c ƒë·ªãnh */
        z-index: 50 !important;
      }

      /* Telegram WebApp Styles */

      /* Base styles for smallest phones (iPhone SE, small Android) */
      @media screen and (max-width: 375px) {
        .phone-container {
          max-width: 100%;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        .resource-header {
          height: 24px;
        }

        #main-stage {
          height: 240px;
          background-position: center bottom -2px;
        }

        .text-lg {
          font-size: 0.875rem;
        }

        .px-4 {
          padding-left: 8px;
          padding-right: 8px;
        }

        /* Auto earn button cho iPhone SE - d∆∞·ªõi ch√¢n younghee */
        .auto-earn-container {
          bottom: 110px !important; /* ƒêi·ªÅu ch·ªânh cho iPhone SE (170px - 60px = 110px) */
        }
      }

      /* Styles for medium phones (iPhone X, 11, 12, 13, most Android) */
      @media screen and (min-width: 376px) and (max-width: 390px) {
        .phone-container {
          max-width: 390px;
        }

        .resource-header {
          height: 26px;
        }

        #main-stage {
          height: 260px;
          background-size: auto 85%;
        }

        .text-lg {
          font-size: 0.925rem;
        }

        .px-4 {
          padding-left: 10px;
          padding-right: 10px;
        }

        /* Character overlay adjustments for iPhone 12 Pro */
        #character-overlay {
          bottom: 200px !important;
        }

        /* Bottom layout adjustments for iPhone 12 Pro */
        .bottom-layout-image {
          bottom: -20px !important;
        }

        /* Auto earn button cho iPhone 12 Pro - d∆∞·ªõi ch√¢n younghee */
        .auto-earn-container {
          bottom: 140px !important; /* ƒêi·ªÅu ch·ªânh cho iPhone 12 Pro (200px - 60px = 140px) */
        }
      }

      /* Styles for larger phones (iPhone Pro Max, larger Android) */
      @media screen and (min-width: 391px) {
        .phone-container {
          max-width: 428px;
        }

        .resource-header {
          height: 28px;
        }

        #main-stage {
          height: 280px;
          background-size: auto 85%;
        }

        /* Character overlay adjustments for iPhone 14 Pro Max */
        #character-overlay {
          bottom: 210px !important;
        }

        /* Bottom layout adjustments for iPhone 14 Pro Max */
        .bottom-layout-image {
          bottom: -25px !important;
        }

        /* Auto earn button cho iPhone 14 Pro Max - d∆∞·ªõi ch√¢n younghee */
        .auto-earn-container {
          bottom: 150px !important; /* ƒêi·ªÅu ch·ªânh cho iPhone 14 Pro Max (210px - 60px = 150px) */
        }

        /* Bottom navigation adjustments for larger phones */
        #bottom-nav {
          bottom: 20px !important;
          z-index: 30 !important;
        }
      }

      /* Specific adjustments for iPhone 15 Pro (393x852) */
      @media screen and (min-width: 390px) and (max-width: 395px) and (min-height: 844px) {
        .phone-container {
          max-width: 393px;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        /* Bottom navigation specific for iPhone 15 Pro */
        #bottom-nav {
          bottom: 34px !important; /* Account for home indicator */
          z-index: 30 !important;
          padding-bottom: 10px !important;
        }

        /* Character overlay adjustments for iPhone 15 Pro */
        #character-overlay {
          bottom: 220px !important;
        }

        /* Bottom layout adjustments for iPhone 15 Pro */
        .bottom-layout-image {
          bottom: -15px !important;
        }

        /* Auto earn button cho iPhone 15 Pro - d∆∞·ªõi ch√¢n younghee */
        .auto-earn-container {
          bottom: 160px !important; /* ƒêi·ªÅu ch·ªânh cho iPhone 15 Pro (220px - 60px = 160px) */
        }
      }

      /* General iPhone adjustments for devices with home indicator */
      @media screen and (min-width: 375px) and (min-height: 812px) {
        #bottom-nav {
          bottom: 34px !important; /* Safe area for home indicator */
          padding-bottom: 10px !important;
        }
      }

      /* Portrait mode optimization for shorter screens */
      @media screen and (max-height: 700px) {
        .phone-container {
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        .pt-6 {
          padding-top: 0.75rem;
        }

        #main-stage {
          height: 220px;
          background-size: auto 85%;
        }

        .mb-4 {
          margin-bottom: 0.5rem;
        }

        /* Auto earn button cho m√†n h√¨nh ng·∫Øn - d∆∞·ªõi ch√¢n younghee */
        .auto-earn-container {
          bottom: 120px !important; /* ƒêi·ªÅu ch·ªânh cho m√†n h√¨nh ng·∫Øn */
        }
      }

      /* Common mobile adjustments */
      @media screen and (max-width: 428px) {
        .level-bars {
          height: 8px;
        }

        .progress-icon {
          height: 12px;
        }

        /* ƒêi·ªÅu ch·ªânh kho·∫£ng c√°ch */
        .space-x-4 > * + * {
          margin-left: 0.75rem;
        }
      }

      /* Bottom layout adjustments */
      .bottom-layout-image {
        z-index: 10;
      }

      /* Bottom layout flash effect */
      .bottom-layout-flash {
        transition: all 0.3s ease;
        -webkit-transition: all 0.3s ease;
        -moz-transition: all 0.3s ease;
        -o-transition: all 0.3s ease;
      }

      .bottom-layout-flash.flash-active {
        filter: brightness(1.5) saturate(1.3) contrast(1.2);
        -webkit-filter: brightness(1.5) saturate(1.3) contrast(1.2);
        animation: pulseGlow 0.8s ease-out;
        -webkit-animation: pulseGlow 0.8s ease-out;
        -moz-animation: pulseGlow 0.8s ease-out;
        -o-animation: pulseGlow 0.8s ease-out;

        /* Fallback for older browsers */
        transform: scale(1.02);
        -webkit-transform: scale(1.02);
        -moz-transform: scale(1.02);
        -o-transform: scale(1.02);
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        -webkit-box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        -moz-box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
      }

      @keyframes pulseGlow {
        0% {
          filter: brightness(1) saturate(1) contrast(1);
          -webkit-filter: brightness(1) saturate(1) contrast(1);
          transform: scale(1);
          -webkit-transform: scale(1);
        }
        50% {
          filter: brightness(1.8) saturate(1.5) contrast(1.3);
          -webkit-filter: brightness(1.8) saturate(1.5) contrast(1.3);
          transform: scale(1.03);
          -webkit-transform: scale(1.03);
        }
        100% {
          filter: brightness(1) saturate(1) contrast(1);
          -webkit-filter: brightness(1) saturate(1) contrast(1);
          transform: scale(1);
          -webkit-transform: scale(1);
        }
      }

      @-webkit-keyframes pulseGlow {
        0% {
          -webkit-filter: brightness(1) saturate(1) contrast(1);
          -webkit-transform: scale(1);
        }
        50% {
          -webkit-filter: brightness(1.8) saturate(1.5) contrast(1.3);
          -webkit-transform: scale(1.03);
        }
        100% {
          -webkit-filter: brightness(1) saturate(1) contrast(1);
          -webkit-transform: scale(1);
        }
      }

      /* Mobile optimized flash effect */
      @media (max-width: 768px) {
        .bottom-layout-flash.flash-active {
          filter: brightness(2) saturate(1.8) contrast(1.4);
          -webkit-filter: brightness(2) saturate(1.8) contrast(1.4);
          animation: mobileFlash 0.8s ease-out;
          -webkit-animation: mobileFlash 0.8s ease-out;
          -moz-animation: mobileFlash 0.8s ease-out;
          -o-animation: mobileFlash 0.8s ease-out;

          /* Enhanced mobile fallback */
          transform: scale(1.05);
          -webkit-transform: scale(1.05);
          -moz-transform: scale(1.05);
          -o-transform: scale(1.05);
          box-shadow: 0 0 30px rgba(255, 255, 255, 0.5),
            inset 0 0 20px rgba(255, 255, 255, 0.2);
          -webkit-box-shadow: 0 0 30px rgba(255, 255, 255, 0.5),
            inset 0 0 20px rgba(255, 255, 255, 0.2);
          -moz-box-shadow: 0 0 30px rgba(255, 255, 255, 0.5),
            inset 0 0 20px rgba(255, 255, 255, 0.2);

          /* Hardware acceleration for mobile */
          -webkit-transform: translateZ(0) scale(1.05);
          -moz-transform: translateZ(0) scale(1.05);
          transform: translateZ(0) scale(1.05);
          will-change: transform, filter, box-shadow;
          -webkit-backface-visibility: hidden;
          -moz-backface-visibility: hidden;
          backface-visibility: hidden;
        }

        @keyframes mobileFlash {
          0% {
            filter: brightness(1) saturate(1) contrast(1);
            -webkit-filter: brightness(1) saturate(1) contrast(1);
            transform: translateZ(0) scale(1);
            -webkit-transform: translateZ(0) scale(1);
            box-shadow: 0 0 0 rgba(255, 255, 255, 0);
            -webkit-box-shadow: 0 0 0 rgba(255, 255, 255, 0);
          }
          25% {
            filter: brightness(2.2) saturate(2) contrast(1.5);
            -webkit-filter: brightness(2.2) saturate(2) contrast(1.5);
            transform: translateZ(0) scale(1.08);
            -webkit-transform: translateZ(0) scale(1.08);
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.7),
              inset 0 0 25px rgba(255, 255, 255, 0.3);
            -webkit-box-shadow: 0 0 40px rgba(255, 255, 255, 0.7),
              inset 0 0 25px rgba(255, 255, 255, 0.3);
          }
          50% {
            filter: brightness(2.5) saturate(2.2) contrast(1.6);
            -webkit-filter: brightness(2.5) saturate(2.2) contrast(1.6);
            transform: translateZ(0) scale(1.1);
            -webkit-transform: translateZ(0) scale(1.1);
            box-shadow: 0 0 50px rgba(255, 255, 255, 0.8),
              inset 0 0 30px rgba(255, 255, 255, 0.4);
            -webkit-box-shadow: 0 0 50px rgba(255, 255, 255, 0.8),
              inset 0 0 30px rgba(255, 255, 255, 0.4);
          }
          75% {
            filter: brightness(1.8) saturate(1.5) contrast(1.3);
            -webkit-filter: brightness(1.8) saturate(1.5) contrast(1.3);
            transform: translateZ(0) scale(1.05);
            -webkit-transform: translateZ(0) scale(1.05);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.5),
              inset 0 0 20px rgba(255, 255, 255, 0.2);
            -webkit-box-shadow: 0 0 30px rgba(255, 255, 255, 0.5),
              inset 0 0 20px rgba(255, 255, 255, 0.2);
          }
          100% {
            filter: brightness(1) saturate(1) contrast(1);
            -webkit-filter: brightness(1) saturate(1) contrast(1);
            transform: translateZ(0) scale(1);
            -webkit-transform: translateZ(0) scale(1);
            box-shadow: 0 0 0 rgba(255, 255, 255, 0);
            -webkit-box-shadow: 0 0 0 rgba(255, 255, 255, 0);
          }
        }

        @-webkit-keyframes mobileFlash {
          0% {
            -webkit-filter: brightness(1) saturate(1) contrast(1);
            -webkit-transform: translateZ(0) scale(1);
            -webkit-box-shadow: 0 0 0 rgba(255, 255, 255, 0);
          }
          25% {
            -webkit-filter: brightness(2.2) saturate(2) contrast(1.5);
            -webkit-transform: translateZ(0) scale(1.08);
            -webkit-box-shadow: 0 0 40px rgba(255, 255, 255, 0.7),
              inset 0 0 25px rgba(255, 255, 255, 0.3);
          }
          50% {
            -webkit-filter: brightness(2.5) saturate(2.2) contrast(1.6);
            -webkit-transform: translateZ(0) scale(1.1);
            -webkit-box-shadow: 0 0 50px rgba(255, 255, 255, 0.8),
              inset 0 0 30px rgba(255, 255, 255, 0.4);
          }
          75% {
            -webkit-filter: brightness(1.8) saturate(1.5) contrast(1.3);
            -webkit-transform: translateZ(0) scale(1.05);
            -webkit-box-shadow: 0 0 30px rgba(255, 255, 255, 0.5),
              inset 0 0 20px rgba(255, 255, 255, 0.2);
          }
          100% {
            -webkit-filter: brightness(1) saturate(1) contrast(1);
            -webkit-transform: translateZ(0) scale(1);
            -webkit-box-shadow: 0 0 0 rgba(255, 255, 255, 0);
          }
        }

        /* iOS Safari specific optimizations */
        @supports (-webkit-touch-callout: none) {
          .bottom-layout-flash.flash-active {
            -webkit-transform: translate3d(0, 0, 0) scale(1.05);
            transform: translate3d(0, 0, 0) scale(1.05);
            -webkit-perspective: 1000px;
            perspective: 1000px;
          }
        }
      }

      /* Character press down effect */
      .character-press {
        animation: characterPressDown 0.8s ease-out;
        -webkit-animation: characterPressDown 0.8s ease-out;
        -moz-animation: characterPressDown 0.8s ease-out;
        -o-animation: characterPressDown 0.8s ease-out;
      }

      @keyframes characterPressDown {
        0% {
          transform: translateY(0px) scale(1);
        }
        25% {
          transform: translateY(8px) scale(0.98);
        }
        50% {
          transform: translateY(12px) scale(0.96);
        }
        75% {
          transform: translateY(6px) scale(0.99);
        }
        100% {
          transform: translateY(0px) scale(1);
        }
      }

      @-webkit-keyframes characterPressDown {
        0% {
          -webkit-transform: translateY(0px) scale(1);
        }
        25% {
          -webkit-transform: translateY(8px) scale(0.98);
        }
        50% {
          -webkit-transform: translateY(12px) scale(0.96);
        }
        75% {
          -webkit-transform: translateY(6px) scale(0.99);
        }
        100% {
          -webkit-transform: translateY(0px) scale(1);
        }
      }

      /* Styles cho web th∆∞·ªùng */
      .standalone-web {
        max-width: 960px;
        margin: 0 auto;
      }

      /* Telegram WebApp Responsive Styles */

      /* Base styles for smallest phones (iPhone SE) */
      @media screen and (max-width: 375px) {
        .resource-header {
          height: 24px;
        }

        #main-stage {
          height: 240px;
          background-size: auto 85%;
          transform: translateY(15px);
        }

        .text-lg {
          font-size: 0.875rem;
        }

        .px-4 {
          padding-left: 8px;
          padding-right: 8px;
        }

        .space-x-3 > * + * {
          margin-left: 0.5rem;
        }

        .mb-4 {
          margin-bottom: 0.75rem;
        }
      }

      /* Styles for medium phones (iPhone X, 11, 12, 13, most Android) */
      @media screen and (min-width: 376px) and (max-width: 390px) {
        .resource-header {
          height: 26px;
        }

        #main-stage {
          height: 260px;
          background-size: auto 85%;
        }

        .text-lg {
          font-size: 0.925rem;
        }

        .px-4 {
          padding-left: 10px;
          padding-right: 10px;
        }
      }

      /* Styles for larger phones (iPhone Pro Max, larger Android) */
      @media screen and (min-width: 391px) {
        .resource-header {
          height: 30px;
        }

        #main-stage {
          height: 315px;
          background-size: auto 85%;
        }

        .text-lg {
          font-size: 1rem;
        }
      }

      /* Portrait mode optimization */
      @media screen and (max-height: 700px) {
        .pt-6 {
          padding-top: 0.75rem;
        }

        #main-stage {
          height: 220px;
          background-size: auto 85%;
        }

        .mb-4 {
          margin-bottom: 0.5rem;
        }
      }

      /* HIGH PRIORITY OVERRIDE - Must be last to override all media queries */
      .auto-earn-container {
        position: absolute !important;
        right: 16px !important;
        bottom: 180px !important; /* ƒê·∫∑t d∆∞·ªõi ch√¢n younghee m·∫∑c ƒë·ªãnh */
        z-index: 50 !important;
      }

      /* Force bottom-nav to be visible on all devices */
      #bottom-nav {
        position: fixed !important;
        bottom: 5px !important;
        left: 0 !important;
        right: 0 !important;
        z-index: 50 !important;
        padding: 0 16px !important;
        pointer-events: auto !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      /* Ensure bottom-nav content is visible */
      #bottom-nav > div {
        background-color: #27012a !important;
        border: 1px solid rgba(215, 12, 163, 0.42) !important;
        border-radius: 9999px !important;
        padding: 16px !important;
        display: flex !important;
        justify-content: space-around !important;
        align-items: center !important;
      }

      /* iPhone with home indicator adjustments */
      @media screen and (min-height: 812px) {
        #bottom-nav {
          bottom: 34px !important;
          padding-bottom: 10px !important;
        }
      }

      /* iPhone SE specific adjustments */
      @media screen and (max-width: 375px) {
        .bottom-layout-image {
          bottom: -75px !important;
        }

        /* Character overlay adjustments for iPhone SE */
        #character-overlay {
          bottom: 170px !important;
          height: 240px !important;
        }

        /* Auto earn button cho iPhone SE - d∆∞·ªõi ch√¢n younghee */
        .auto-earn-container {
          bottom: 110px !important; /* 170px - 60px = 110px */
        }

        /* Auto earn button size adjustment */
        #auto-earn-button {
          width: 40px !important;
          padding: 8px !important;
        }

        #auto-earn-button img {
          width: 18px !important;
          height: 18px !important;
        }

        /* Auto earn text size */
        .gugi-regular.text-xs {
          font-size: 10px !important;
        }

        /* Bottom navigation for iPhone SE */
        #bottom-nav {
          bottom: 10px !important;
        }
      }

      /* Real mobile device detection and fixes */
      @media only screen and (max-device-width: 480px) {
        html {
          height: 100%;
          height: -webkit-fill-available;
        }

        body {
          overflow: hidden;
          position: fixed;
          width: 100vw;
          height: 100vh;
          height: -webkit-fill-available;
          /* Force hide browser UI */
          -webkit-appearance: none;
          -webkit-user-select: none;
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: transparent;
        }

        .phone-container {
          max-width: 100vw;
          width: 100vw;
          height: 100vh;
          height: -webkit-fill-available;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          -webkit-transform: none;
          position: fixed;
          box-shadow: none;
          /* Force use device screen dimensions */
          min-height: 100vh;
          min-height: -webkit-fill-available;
          max-height: 100vh;
          max-height: -webkit-fill-available;
        }
      }

      /* iPhone specific fixes */
      @media only screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) {
        /* iPhone 6/7/8/SE 2020 */
        .phone-container {
          max-width: 100vw;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        .auto-earn-container {
          bottom: 110px !important;
        }

        #character-overlay {
          bottom: 170px !important;
        }
      }

      @media only screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) {
        /* iPhone XR/11 */
        .phone-container {
          max-width: 100vw;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        .auto-earn-container {
          bottom: 150px !important;
        }

        #character-overlay {
          bottom: 210px !important;
        }

        #bottom-nav {
          bottom: 34px !important;
          padding-bottom: 10px !important;
        }
      }

      @media only screen and (device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) {
        /* iPhone 12/13/14 */
        .phone-container {
          max-width: 100vw;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        .auto-earn-container {
          bottom: 140px !important;
        }

        #character-overlay {
          bottom: 200px !important;
        }

        #bottom-nav {
          bottom: 34px !important;
          padding-bottom: 10px !important;
        }
      }

      @media only screen and (device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) {
        /* iPhone 12/13/14 Pro Max */
        .phone-container {
          max-width: 100vw;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        .auto-earn-container {
          bottom: 150px !important;
        }

        #character-overlay {
          bottom: 210px !important;
        }

        #bottom-nav {
          bottom: 34px !important;
          padding-bottom: 10px !important;
        }
      }

      @media only screen and (device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) {
        /* iPhone 15 Pro */
        html,
        body {
          height: 852px !important;
          max-height: 852px !important;
          overflow: hidden !important;
        }

        .phone-container {
          height: 852px !important;
          max-height: 852px !important;
          width: 393px !important;
          max-width: 393px !important;
        }

        /* Force elements to use device screen height */
        #main-stage {
          height: 280px !important;
        }

        #character-overlay {
          bottom: 220px !important;
        }

        .auto-earn-container {
          bottom: 160px !important;
        }

        #bottom-nav {
          bottom: 34px !important;
          padding-bottom: 10px !important;
        }
      }

      /* Android device fixes */
      @media only screen and (max-device-width: 480px) and (orientation: portrait) {
        .phone-container {
          max-width: 100vw;
          width: 100vw;
          height: 100vh;
          border-radius: 0;
          top: 0;
          left: 0;
          transform: none;
          position: fixed;
        }

        .auto-earn-container {
          bottom: 140px !important;
        }

        #character-overlay {
          bottom: 200px !important;
        }

        #bottom-nav {
          bottom: 20px !important;
        }
      }

      /* Alternative media query for similar window sizes */
      @media only screen and (min-width: 390px) and (max-width: 395px) and (min-height: 645px) and (max-height: 655px) {
        html,
        body {
          height: 100vh !important;
          max-height: 100vh !important;
          overflow: hidden !important;
          position: fixed !important;
          width: 100vw !important;
          max-width: 100vw !important;
        }

        .phone-container {
          height: 100vh !important;
          max-height: 100vh !important;
          width: 100vw !important;
          max-width: 100vw !important;
          border-radius: 0 !important;
          top: 0 !important;
          left: 0 !important;
          transform: none !important;
          position: fixed !important;
          box-shadow: none !important;
        }

        #main-stage {
          height: 260px !important;
        }

        #character-overlay {
          bottom: 125px !important; /* L√πi xu·ªëng ti·∫øp ƒë·ªÉ ph√π h·ª£p v·ªõi 393x651 */
          height: 260px !important;
        }

        .auto-earn-container {
          bottom: 40px !important; /* ƒêi·ªÅu ch·ªânh theo character overlay m·ªõi */
        }

        #bottom-nav {
          bottom: 10px !important;
          padding-bottom: 0px !important;
        }

        .bottom-layout-image {
          bottom: -110px !important; /* L√πi xu·ªëng ti·∫øp ƒë·ªÉ ph√π h·ª£p v·ªõi 393x651 */
        }
      }

      /* Specific fix for window size 393x651 (iPhone 15 Pro with browser UI) - MUST COME LAST */
      @media only screen and (width: 393px) and (height: 651px) {
        html,
        body {
          height: 100vh !important;
          max-height: 100vh !important;
          overflow: hidden !important;
          position: fixed !important;
          width: 100vw !important;
          max-width: 100vw !important;
        }

        .phone-container {
          height: 100vh !important;
          max-height: 100vh !important;
          width: 100vw !important;
          max-width: 100vw !important;
          border-radius: 0 !important;
          top: 0 !important;
          left: 0 !important;
          transform: none !important;
          position: fixed !important;
          box-shadow: none !important;
        }

        /* Force elements to use available window height */
        #main-stage {
          height: 260px !important;
        }

        #character-overlay {
          bottom: 125px !important; /* L√πi xu·ªëng ti·∫øp t·ª´ 130px xu·ªëng 100px */
          height: 260px !important;
        }

        .auto-earn-container {
          bottom: 70px !important; /* ƒêi·ªÅu ch·ªânh theo character overlay m·ªõi (100px - 60px = 40px) */
        }

        /* Bottom nav specific for 393x651 - higher specificity and last in cascade */
        body .phone-container #bottom-nav {
          bottom: 10px !important;
          padding-bottom: 0px !important;
        }

        /* Adjust stats panel for smaller height */
        #stats-panel {
          margin-bottom: 12px !important;
          padding: 12px !important;
        }

        .resource-header {
          height: 24px !important;
          padding: 8px 12px !important;
        }

        /* Compact spacing */
        .mb-4 {
          margin-bottom: 8px !important;
        }

        .space-x-3 > * + * {
          margin-left: 8px !important;
        }

        /* Bottom layout adjustments - l√πi xu·ªëng ti·∫øp */
        .bottom-layout-image {
          bottom: -110px !important; /* L√πi xu·ªëng ti·∫øp t·ª´ -90px xu·ªëng -110px */
        }
      }
    </style>
  </head>
  <body>
    <!-- Debug button for mobile testing -->
    <div
      id="debug-toggle"
      style="
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 10000;
        background: rgba(255, 0, 0, 0.7);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 12px;
        cursor: pointer;
        display: none;
      "
    >
      DEBUG
    </div>

    <!-- Phone Container -->
    <div class="phone-container">
      <!-- Game Container -->
      <div class="game-container">
        <!-- Resource Header -->
        <div class="flex space-x-3 mb-4">
          <!-- Ruby Counter -->
          <div
            class="resource-header background-color-gradient flex-1 rounded-full px-4 py-3 flex items-center space-x-3"
          >
            <div class="w-5 h-5 rounded-full flex items-center justify-center">
              <img
                src="./images/screen1/icons/ruby-icon.svg"
                alt="Ruby Icon"
                class="w-5 h-5"
              />
            </div>
            <span class="gugi-regular text-white font-bold text-lg">0</span>
          </div>

          <!-- Coin Counter -->
          <div
            class="resource-header background-color-gradient flex-1 rounded-full px-4 py-3 flex items-center space-x-3"
          >
            <div class="w-5 h-5 rounded-full flex items-center justify-center">
              <img
                src="./images/screen1/icons/coin-icon.svg"
                alt="Coin Icon"
                class="w-5 h-5"
                id="coin-target"
              />
            </div>
            <span
              id="coin-count"
              class="gugi-regular text-white font-bold text-lg"
              >0</span
            >
          </div>
        </div>

        <!-- Stats Panel -->
        <div
          id="stats-panel"
          class="background-color-gradient bg-opacity-30 rounded-2xl p-4 mb-4 relative"
        >
          <!-- HP Section -->
          <div class="mb-4 flex items-center justify-between gap-6">
            <div class="flex flex-col justify-between items-center mb-2 w-full">
              <div class="flex items-center justify-between w-full mb-2">
                <span class="gugi-regular text-[#FF6B8B]">HP</span>
                <span id="hp-per-level" class="gugi-regular text-white"
                  >100/100</span
                >
              </div>
              <div class="w-full h-3 relative">
                <div class="hp-progress-container">
                  <div class="progress-bar"></div>
                  <div class="progress-icon"></div>
                </div>
              </div>
            </div>
            <div
              class="flex flex-col items-center px-2 py-3 rounded-[12px] w-[100px]"
              style="background-color: #fc376621"
            >
              <img
                src="./images/screen1/icons/coin-icon.svg"
                alt="Point Icon"
                class="w-5 h-5"
                id="coin-target-stats"
              />
              <span id="coin-earn" class="gugi-regular text-white font-bold"
                >0</span
              >
            </div>
          </div>
          <div
            style="
              width: 319px;
              height: 1.5px;
              background: radial-gradient(
                closest-side at 50% 50%,
                rgba(249, 238, 246, 0.35) 0%,
                rgba(215, 12, 163, 0) 100%
              );
              margin: 16px auto;
            "
          ></div>
          <!-- Level Bars -->
          <div class="flex space-x-4">
            <div class="flex-1">
              <div class="flex justify-between items-center mb-2">
                <span class="gugi-regular text-[#FF6B8B]">HP lv</span>
                <span id="hp-level" class="gugi-regular text-white font-bold"
                  >1/100</span
                >
              </div>
              <div class="relative level-bars w-full">
                <div class="hp-level-progress-container">
                  <div class="level-progress-bar"></div>
                  <div class="level-progress-icon"></div>
                </div>
              </div>
            </div>

            <div class="flex-1">
              <div class="flex justify-between items-center mb-2">
                <span class="gugi-regular text-[#FF6B8B]">MT lv</span>
                <span id="lp-level" class="gugi-regular text-white font-bold"
                  >1/100</span
                >
              </div>
              <div class="relative level-bars w-full">
                <div class="lp-level-progress-container">
                  <div class="level-progress-bar"></div>
                  <div class="level-progress-icon"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Event Button and Game 2 Button -->
        <div class="flex justify-end space-x-4">
          <!-- Event Button -->
          <div
            class="background-color-gradient rounded-xl flex justify-center w-[104px]"
          >
            <button class="pt-3 flex flex-col items-center justify-center">
              <span class="gugi-regular text-white text-xs font-bold"
                >Ïù¥Î≤§Ìä∏</span
              >
              <img
                src="./images/screen1/icons/event-icon.svg"
                alt="Event Icon"
                class="w-[65px] h-[65px]"
              />
            </button>
          </div>

          <!-- Game 2 Button -->
        </div>

        <!-- Main Stage Area -->
        <div id="main-stage" class="relative h-[290px] z-30">
          <!-- Character will appear here with highest z-index -->
        </div>
      </div>

      <!-- Auto Earn Button - positioned independently to stay below younghee's feet -->
      <div class="auto-earn-container">
        <div class="flex flex-col items-center space-y-2">
          <button
            id="auto-earn-button"
            class="py-3 flex flex-col items-center justify-center background-color-gradient rounded-xl w-[48px]"
          >
            <img
              src="./images/screen1/icons/auto-earn.svg"
              alt="Event Icon"
              class="w-[22px] h-[22px]"
            />
          </button>
          <span class="gugi-regular text-[#FF6B8B] text-xs font-bold"
            >Auto earn</span
          >
        </div>
      </div>

      <!-- Character overlay to appear above bottom layout -->
      <div
        id="character-overlay"
        class="absolute bottom-[240px] left-0 right-0 z-40 pointer-events-none"
      >
        <div
          class="w-full h-[280px] bg-no-repeat bg-center bg-contain"
          style="
            background-image: url('./images/screen1/character.svg');
            background-position: center bottom;
            background-size: auto 90%;
          "
        ></div>
      </div>

      <!-- Add coin container for flying coins -->
      <div id="coin-container" class="coin-container"></div>

      <!-- Tap area behind bottom layout -->
      <div
        class="absolute bottom-0 left-0 right-0 h-[200px] z-5"
        id="bottom-tap-area"
        style="pointer-events: auto"
      ></div>

      <!-- Bottom Layout Image -->
      <div
        class="absolute bottom-0 left-0 right-0 flex justify-center items-center pointer-events-none z-10 bottom-layout-image bottom-layout-flash"
        id="bottom-layout-container"
      >
        <img
          src="./images/screen1/bottom-layout.png"
          alt="Bottom Layout"
          class="w-[104%] max-w-md object-contain"
          style="transform: translateX(-12px)"
        />
      </div>

      <!-- Bottom Navigation -->
      <div id="bottom-nav" class="absolute bottom-5 left-0 right-0 px-4 z-20">
        <div
          class="flex justify-around items-center py-4 px-4 background-bottom-nav rounded-full"
        >
          <button class="">
            <image
              src="./images/screen1/icons/shopping-cart-icon.svg"
              alt="Shopping Cart Icon"
              class="w-6 h-6 text-game-pink"
            />
          </button>

          <button class="">
            <image
              src="./images/screen1/icons/refresh-icon.svg"
              alt="Refresh Icon"
              class="w-6 h-6 text-game-pink"
            />
          </button>

          <button class="">
            <image
              src="./images/screen1/icons/wallet-icon.svg"
              alt="Wallet Icon"
              class="w-6 h-6 text-game-pink"
            />
          </button>

          <button class="">
            <image
              src="./images/screen1/icons/star-icon.svg"
              alt="Star Icon"
              class="w-6 h-6 text-game-pink"
            />
          </button>

          <button class="">
            <image
              src="./images/screen1/icons/building-icon.svg"
              alt="Building Icon"
              class="w-6 h-6 text-game-pink"
            />
          </button>
        </div>
      </div>
    </div>

    <script>
      // Game logic will go here
      console.log("Telegram Game Loaded");

      // Example: Handle navigation clicks
      document
        .querySelectorAll("#bottom-nav button")
        .forEach((button, index) => {
          button.addEventListener("click", () => {
            console.log(`Navigation button ${index + 1} clicked`);
            // Add navigation logic here
          });
        });

      // Flying coin effect is handled in taptoearn.js tap function
      // No need for separate click listener here
    </script>
    <script src="./js/taptoearn.js"></script>
    <script src="./js/telegram-integration.js"></script>

    <!-- Level Up Popup -->
    <div id="level-up-popup" class="level-up-popup">
      <div class="level-up-content">
        <div class="level-up-emoji">üéâ</div>
        <div class="level-up-text-container">
          <div class="level-up-title">Level Up!</div>
          <div class="level-up-description">
            New rewards unlocked and stronger power await you.
          </div>
        </div>
        <button
          id="level-up-confirm-btn"
          class="level-up-button"
          onclick="closeLevelUpPopupInline(event)"
        >
          <span class="level-up-button-text">Confirm</span>
        </button>
      </div>
    </div>

    <script>
      // ƒê·ªãnh nghƒ©a h√†m ƒë√≥ng popup tr·ª±c ti·∫øp trong HTML
      function closeLevelUpPopupInline(event) {
        console.log("closeLevelUpPopupInline called");

        // NgƒÉn event bubbling v√† default behavior
        if (event) {
          event.preventDefault();
          event.stopPropagation();
          event.stopImmediatePropagation();
        }

        const popup = document.getElementById("level-up-popup");
        if (popup) {
          console.log("Hiding popup inline");
          popup.classList.remove("show");
          popup.style.display = "none";
          popup.style.opacity = "0";
          popup.style.visibility = "hidden";
          popup.style.pointerEvents = "none";
          console.log("Popup hidden successfully");
        } else {
          console.error("Popup not found in inline function!");
        }

        return false; // NgƒÉn th√™m event propagation
      }

      // Test function
      function testPopup() {
        console.log("Testing popup");
        const popup = document.getElementById("level-up-popup");
        if (popup) {
          popup.style.display = "flex";
          popup.style.opacity = "1";
          popup.style.visibility = "visible";
          popup.style.pointerEvents = "auto";
          popup.classList.add("show");
          console.log("Test popup shown");
        }
      }
    </script>
  </body>
</html>
